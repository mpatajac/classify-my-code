import torch

from flask import Flask
from model import Classifier
app = Flask(__name__)

classifier = Classifier()
demo_data = torch.tensor([[
    24272,    40, 81547,    13,   698, 17886,  3346,    44,    74,    32,
    1827,    14,   151,    17,   111,     3,  1284,     5,   327,   144,
    19,     1,   877,    11,    68,   276,  1148,   397,    33,   118,
    273,    35,   167,     5,   391,   161,    40,  2243,    14,     1,
    544,    88,    76,   101,     4,     1,  3223,    13,    41,     3,
    402,  1055,   135,  8021,    42,   178,   137,    13,  3004,     1,
    324,    19,  4843, 28002,   339,     5,  3055,  2074,     1, 19664,
    18898,    40,  8021,    43,  3582,    26,   362,     5,   128,    57,
    19,     1,  1884,    17,    46,    43,    21,    68,   337,     3,
    2053,     5,   416,    19,     1,  1884,    14,     3,  3194,   201,
    1, 32032,    21,   276,    66,    35,     3,   338,     1,   695,
    706,     3,  3768,  1208,    19,     1,  1647,     3,  1215,     2,
    273,    21,   276,  2425,     5,    65,    46, 89528,    37,     5,
    26,  3223,    11,     6, 22419, 89528,  1986,  3632,  2821,    33,
    4127,    33,   378,    13, 11975,   290,     3,   997,   125,    33,
    44,   273,     8,     1,   175,   352,  6875,     5,    95,     3,
    2053,    15,     3,  4931,  2917, 14794, 21157,     5,    65,    43,
    22,    67,   416,     8,     1,  1884,    14,  3720,   484,   201,
    1, 32032,    43, 11975,  2797,    22,    67,    82,    46,    22,
    474,    15,     3,   676,  1141,     4,   245,    50,  4418,     1,
    89528,    19,   114, 11975,     6,  1337,    19,     1,   877,    15,
    3, 19956,    19,    24,  4065,     5, 10231,    24,   172,   815,
    114,    22,   186,  1585,   130,     1,  6435, 89528,   337,     1,
    13615, 47261,    31,     3, 38314,    99, 89528,   417,    19,    24,
    11854,   114, 11975,   879,    79,   102,   564,     3,   235,    31,
    1,   394,     4,  4619, 19217,  1899,  3724,    32, 39720,    33,
    183,  4206,   156,  2247,    39,   338,     2,    39,  9060,  6824,
    1949,  4274,     2, 31753,  9233,  2440,    33,    23,   448,   336,
    5,     1,  1884,   488,  4145, 11975,   209, 89528,    20,   336,
    5,  4473,  5868, 33392,    37,    22,   276,   118,    51,   109,
    997,   114, 89528,   534,    40,  2794,   495,    40,    26,   539,
    135,     1,   115,  1965,   195,  4619,     2, 11975,   274,  1623,
    5,   112,     9,   249,   117,  4281,     5,    26,    27,     4,
    3632, 89528, 17007,   105,   114,  2491,     5,   109,     3,   208,
    7,   277,     3,  4183,   503,  1040,     5,    24,  2705,   161,
    137,    13,  7584, 11631,   180,  4623,    40, 19934,    14,     1,
    544,     5,   119,    46, 89528,    37,   250,   139,  4438,   156,
    2247,     7,     1,   362,   251,    40,    19,     1,    79,   535,
    245,     3,   364,  2053,    37,    29,   997,    76,    82,    51,
    34,    89,   120,    46,     5,    82,    15,    64,   268,   267,
    34,   140,   193,     7,     5,     1,  3223,   295,     4,   748,
    7,    37, 17302,   268,    40,   267,    10,    18,    77,  5830,
    21,     5,   327,   384
]])


@app.route('/')
def hello():
    return "Hello World!"


@app.route('/test')
def test():
    result = classifier.classify(demo_data)
    return f"got {result}, should be 1 {'✔' if (1 - result) < .5 else '❌'}"
